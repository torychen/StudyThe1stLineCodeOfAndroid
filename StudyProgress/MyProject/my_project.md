## 时间安排 2018.12.5
2018.12 - 2019.3
9:00- 18:30 OP 项目
22:00-24:00 找工作（Android 应用开发， 嵌入式）


12.5 无人机项目 - 简历更新

---


GPIO驱动学习


## GPIO 驱动？

---

## IPC
移植ODM，到手机。
UI 侧边栏

---

## 无人机防火
无人机林业巡检系统

华测高精度GNSS无人机航测系统在森林防火中的应用

成都纵横已有相关产品
林业行业应用场景

    森林防火
    毒品种植
    盗砍盗伐

http://www.jouav.com/index.php/Jouav/index/solution.html

系统功能介绍
通过无人机平台，按用户设定航迹对林区进行空中巡查。
并将空中巡查获取的图像数据实时传回地面服务站。
巡查过程中，通过智能算法，判断为疑似火警，立即拍照上传并报警通知地面服务中心。
地面中心对于可疑点或区域，通过遥控指令可改变无人机飞行航迹及飞行高度进行详查，详查图像通过无线链路实时传回地面。

地面巡逻人员配备便携设备，可实时获取无人机信息，如位置和图像，遇到疑似火情，可迅速空地联动，保证快速及时响应处理突发火警。



规划飞行路线，
录像保存
实时分析

可疑位置 拍照分析， GPS定位，保存到本地数据库， 有网络后上传到后台数据库。

---

### 系统设计：


+ 无人机部分  
我司自主研发的红外IPC和第三方无人机平台自带的可见光摄像头一起作为无人机视频采集模块，提供双光实时的视频流数据。
与此同时，当智能算法判断为异常情况时，能够实时通过声音，图像向服务器报警。并且同时记录下GPS位置信息、拍照并上传服务器。

我的职责：
负责完成 红外IPC的研发工作。
基于HTTP和RTSP网络协议，向外界提供onvif协议的标准接入，使得IPC设备可以被用户发现，配置，和接收实时H.264视频流。
基于UDP网络协议，通过我司私有协议，向用户提供测温报警模块的相关配置和使用功能。


+ 服务器端  
无人机的管控，包括无人机注册，登入模块。无人机线路规划调度模块。无人机实时预览模块和无人机报警模块。
便携客户端的管控，包括客户端的注册，登入模块。客户端数据同步模块。 实时数据发布模块。

我的职责负责涉及便携客户端部分相关功能的实现。
后台采用 MySQL 数据库。 前台是 jsp + servlet 动态网页web server。
完成便携客户端的注册，登入模块。 无人机线路规划数据库与客户端数据库同步。 无人机实时信息发布，如位置信息，报警信息等。

+ 便携客户端（安卓）：
当用户完成注册，进入系统后。合法用户可以查询当前无人机的线路规划，并在地图上显示其覆盖范围。
如果当前有无人机在线，可实时获得其位置更新信息，并在地图上实时更新。
用户可查看无人机实时视频。
如有报警信息，可查看无人机上传的照片。

我的职责：
SQLite 数据库 + 百度地图。
通过私有协议与服务器交互，获取无人机的相关信息，并在地图上显示。
通过rtsp协议，获取无人机实时视频流，预览使用 vlc 内核播放。
通过后台服务，基于udp协议，接收无人机实时位置更新信息，并显示在地图上。


数据库名称 
patrol.db

设备表单
create tab device 

sn integer 			name 		  	password     online     ip地址 		type
设备序列号 唯一		无人机别名，		密码			是否上线     ip地址 		无人机/便携设备

---


无人机飞行计划表，
一天可以有多个计划
每个计划可以飞多个位置

create tab position
id 		sn   			action 		datetime	preset point		pos 			type
主键    无人机序列号 		增/删、改		日期			预置点 				位置经纬度       静态规划地址/动态实时地址


报警信息
id 		sn   			action		datetime			pos 			imgpath
主键 	无人机序列号 		增/删、改		日期					位置经纬度       异常图片路径


## design 详细设计
无人机的实时位置信息，断网时，不更新。 联网时，定时通过udp向服务器发送 位置信息。

无人机报警照片怎样上传，更新？ 
异步线程，有新报警照片，写入列表，状态为新增
异步线程，有网络时，检查列表，有新报警照片则，利用socket 上传到服务器，上传成功后，更新状态为 已上传。

==========================================

## TODO
TODO 数据库设计 uml

==========================================

## usecase 用例
## usecase 更新数据库

### usecase 客户端判断是否需要更新本地数据库
+ 服务器端，提供每张表的，当前数据条数，最后修改时间。 从而客户端能判断是否需要更新。


### usecase 服务器端推送更新
+ 服务器端，当增，删，改了数据库。 通过udp，向当前在线的客户端推送数据。
+ 客户端如果打开了接收推送标志， 通过 `id` 找到对应的记录，根据 `action` ，做出相应的动作。


### usecase 客户端同步

